const fs = require("fs");
const path = require("path");
const { VirusTotal } = require("virustotal-api");

// Obtenha sua chave API do VirusTotal
const API_KEY = "YOUR_API_KEY";

// Crie um objeto Virustotal
const vtotal = new VirusTotal(API_KEY);

// Crie uma função para abrir a caixa de seleção
function selecionarArquivo() {
  // Abra uma caixa de seleção no explorador de arquivos
  const file = await fs.promises.openDialog();

  // Verifique se um arquivo foi selecionado
  if (file) {
    // Obter o hash do arquivo
    const fileHash = vtotal.get_file_hash(file.path);

    // Obter o relatório de varredura do arquivo
    const report = await vtotal.get_file_report(fileHash);

    // Exibir o status da análise
    console.log("O arquivo está sendo analisado...");

    // Verifique se o arquivo é malicioso
    if (report.positives > 0) {
      console.log("O arquivo é malicioso.");
    } else {
      console.log("O arquivo não é malicioso.");
    }
  }
}

// Execute a função
selecionarArquivo();